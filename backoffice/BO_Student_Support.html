<!DOCTYPE html>
<!--[if IE]><![endif]-->
<!--[if IE 8 ]><html dir="ltr" lang="en" class="ie8"><![endif]-->
<!--[if IE 9 ]><html dir="ltr" lang="en" class="ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!-->
<html dir="ltr" lang="en">
<!--<![endif]-->
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="format-detection" content="telephone=no">
<title>MyExamPrep</title>
<link href="../images/favicon1.png" rel="icon" />
<meta name="description" content="Personalized Tutoring" />
<script src="../js/jquery-2.1.1.min.js" type="text/javascript"></script>
<!-- <script src="../js/jquery-3.3.1.slim.min.js" type="text/javascript"></script> -->
<link href="../css/bootstrap.min.css" rel="stylesheet" media="screen" />
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script src="../js/bootstrap.min.js" type="text/javascript"></script>
<link href="https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300" rel="stylesheet" type="text/css">
<link href="../css/font-awesome.min.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="../css/magnific-popup.css" />
<link href="//fonts.googleapis.com/css?family=Open+Sans:400,400i,300,700" rel="stylesheet" type="text/css" />
<link href="../css/owl.carousel.min.css" rel="stylesheet">
<script src="../js/owl.carousel.min.js" type="text/javascript"></script>
<script src="../js/theme.js" type="text/javascript"></script>
<link href="../css/stylesheet.css?ver=6" rel="stylesheet">



<script src="../js/common.js" type="text/javascript"></script>
<script src="../js/popper.min.js" type="text/javascript"></script>
<script src="../js/support.js" type="text/javascript"></script>
<link href="../css/font-awesome.min.css" rel="stylesheet" type="text/css" />
<script src="../js/jquery.magnific-popup.min.js"></script>
<script src="../js/moment.min.js" type="text/javascript"></script>
<script src="../js/moment-with-locales.min.js" type="text/javascript"></script>
<script src="../js/bootstrap-datetimepicker.min.js" type="text/javascript"></script>
<!-- <link href="../image/cart.png" rel="icon" /> -->


<!-- #Angular Js -->
<script src="../angular_js/angular.min.js" type="text/javascript"></script>
<script src="../angular_js/angular-route.js" type="text/javascript"></script>
<script src="../angular_js/angular-animate.js" type="text/javascript"></script>
<script src="../angular_js/angular-sanitize.js" type="text/javascript"></script>

<!-- Material Angular -->
<script src="../angular_js/material/angular-aria.min.js" type="text/javascript"></script>
<script src="../angular_js/material/angular-material.js" type="text/javascript"></script>
<link href="../angular_js/material/angular-material.css" rel="stylesheet" type="text/css" />

<!-- Pageing -->
<script src="../angular_js/dirPagination.js" type="text/javascript"></script>
<link href="../css/paging.css?ver=6" rel="stylesheet">

<script src="code/BO_Student_Support.js?ver=6"></script>
<!-- <script src="code/Announcements.js"></script> -->
<style>
  .badge{
    font-size: small!important;
  }

  .bdge {
    height: 21px;
    background-color: black;
    color: #fff;
    font-size: 11px;
    padding: 8px;
    border-radius: 4px;
    line-height: 3px
}

.comments {
    text-decoration: underline;
    text-underline-position: under;
    cursor: pointer
}

.dot {
    height: 7px;
    width: 7px;
    margin-top: 3px;
    background-color: #bbb;
    border-radius: 50%;
    display: inline-block
}

.hit-voting:hover {
    color: blue
}

.hit-voting {
    cursor: pointer
 }
.LOADER{
  display: none;
}
.commented-section{
  background-color: #f9f9f9;
}
.reply-section{
  background-color: #f1f1f1;
}
.reply-section-border{
  border-top: 1px solid #e5e5e5!important;
}
.comment-text-sm p{
    line-height: 36px;
    letter-spacing: 0.5px;
    word-spacing: 3px;
    font-family: monospace;
}
.student-head{
  background: aliceblue;
}
.admin-head{
  background: mintcream;
}
.table th{
  padding: .6rem!important;
}
.table td{
  padding: .6rem!important;
}
.cancel{
  transform: scale(1);
  transition: transform 0.3s ease!important;
  background: dimgray;
}
.cancel:hover{
  transform: scale(1.2,1.2);
  background: crimson;
}
.list-group li{
  background: #fff;
  transition: all 0.3s linear;
}
.list-group li:hover{
  background: #e7e7e7;
}
/* .list-group-item h5{
  background: #f8f9fa;
}
.list-group-item h5:hover{
  background: #dadada;
} */

.list-group-item-active{
    color: #fff!important;
    background-color: #343a40!important;
    border-color: darkorange!important;
}
.STATUS_BADGE{

}
.STATUS_BADGE:hover{
  background: #343a40!important;
  color: #fff!important;
}

</style>
</head>

<body data-ng-app="myApp" data-ng-controller="myCtrl" data-ng-init="init()" class="d-flex flex-column min-vh-100">
 
    

    <!-- Header -->
<div id="menu_wrapper"></div>
<header id="header" class="home">
      
  <div ng-include="'include/header.html?ver=6'"></div>
    
</header>



  <div id="spin-wrapper"></div>
  <div id="siteloader">
      <div class="loader loader-1"></div>
  </div>


	<div id="common-home">    
    <div class="content_middle">
        <section class="ishiproductsblock container mb-0">
          <div class="section-header">
            <h4 class="home-title"><span>STUDENT SUPPORT</span></h4>
          </div>

          <div class="row d-flex flex-column-reverse flex-md-row d-print-none">
            <div class="col-sm-12 col-md-7">
              <!--######### Loader #########-->
             <div class="row LOADER my-4" id="loader">
               <div class="col-12 text-center">
                 <div class="spinner-grow text-dark" role="status">
                   <span class="sr-only">Loading...</span>
                 </div>
                 <div class="spinner-grow text-dark" role="status">
                   <span class="sr-only">Loading...</span>
                 </div>
                 <div class="spinner-grow text-dark" role="status">
                   <span class="sr-only">Loading...</span>
                 </div>
                 <div class="spinner-grow text-dark" role="status">
                   <span class="sr-only">Loading...</span>
                 </div>
               </div>
             </div>

             <div class="row d-flex justify-content-center flex-md-row py-4" ng-hide="RCOUNT > 0">
               <h2 class="text-danger font-weight-bold">Ticket not selected.</h2>
             </div>

             <div bind-html-compile="post.getSupportTicket"></div>
            </div>

            <div class="col-sm-12 col-md-5">
              <!-- Table  -->
              <div class="mb-2 bg-white card card-body rounded-my border-bottom pb-3" id='main-table'>
                <ul class="list-group">
                  <li class="list-group-item bg-secondary" aria-current="true">
                    <h3 class="mb-0 font-weight-bold text-light">
                      <div class="d-flex justify-content-between align-items-center">
                        <div>
                          <span>TICKETS</span>
                        </div>
                        <div class="d-flex align-items-center">
                          <button class="btn btn-dark mr-2 rounded" onclick="print()" title="Print List"><i class="fa fa-print font-15"></i></button>
                          <button class="btn btn-success mr-2 rounded exportToExcel" title="Download Excel File"><i class="fa fa-file-excel-o font-15"></i></button>
                          <button class="btn btn-warning mr-2 rounded" data-toggle="modal" title="Create New Student Ticket" data-target="#TicketModal">
                            <i class="fa fa-plus font-15"></i> Create Ticket
                          </button>
                          <span class="fa fa-refresh pull-right refresh-ticket pointer" title="Refresh" ng-click="getAllTicket()"></span>
                        </div>
                      </div>
                    </h3>
                  </li>
                  <li class="list-group-item bg-secondary">
                    <div class="row">
                      <div class="col-6">
                        <div class="form-group mb-0">
                          <b class="pl-3 d-block text-white">From</b>
                          <input type="date" class="form-control py-0 rounded-pill" ng-change="getAllTicket();" id="txtFromDt" data-ng-model="temp.txtFromDt" autocomplete="off">
                        </div>
                      </div>  
                      <div class="col-6">
                        <div class="form-group mb-0">
                          <b class="pl-3 d-block text-white">To</b>
                          <input type="date" class="form-control py-0 rounded-pill" ng-change="getAllTicket();" id="txtToDt" data-ng-model="temp.txtToDt" autocomplete="off">
                        </div>
                      </div>
                      
                      <div class="col-12 mt-2">
                        <div class="form-group mb-0">
                          <b class="pl-3 d-block text-white">Search by anything</b>
                          <input type="text" class="form-control py-0 rounded-pill" placeholder="Search here..." id="search" data-ng-model="temp.search" autocomplete="off">
                        </div>
                        
                        <div class="custom-control custom-checkbox pull-right rounded-pill px-3 alert-warning">
                          <input type="checkbox" class="custom-control-input pointer" name="chkHideClosed" id="chkHideClosed" 
                                data-ng-model="chkHideClosed" ng-true-value="'1'" ng-false-value="'0'" ng-init="chkHideClosed = '0'">
                          <label class="custom-control-label font-weight-bold pt-1 text-dark pointer" for="chkHideClosed">Hide Closed</label>
                        </div>
                      </div>
                    </div>
                    <div class="row spinTicket" style="display: none;">
                      <div class="col-12 text-center">
                        <div class="spinner-grow spinner-grow-sm text-white" role="status">
                          <span class="sr-only">Loading...</span>
                        </div>
                        <div class="spinner-grow spinner-grow-sm text-white" role="status">
                          <span class="sr-only">Loading...</span>
                        </div>
                        <div class="spinner-grow spinner-grow-sm text-white" role="status">
                          <span class="sr-only">Loading...</span>
                        </div>
                      </div>
                    </div>
                  </li>
                  <li  ng-repeat="x in post.getAllTicket | filter:temp.search" ng-class="{'list-group-item-active' : x.TICKETID == ticketid}" 
                      class="list-group-item pointer px-0 pb-0" ng-click="getSupportTicket(x.TICKETID,'ALL')" ng-hide="x.STATUS == 'CLOSED' && chkHideClosed=='1'">
                    <h4 class="px-3" ng-class="{'text-light' : x.TICKETID == ticketid}">
                      <div class="d-flex justify-content-between">
                        <div>
                          <span ng-bind="x.SUBJECT"></span>
                        </div>
                        <div class="text-nowrap">
                          <span data-toggle="modal" data-target="#Status" class="badge text-light mx-1 STATUS_BADGE" ng-click="temp.ddlStatus=''"
                          ng-class="{'bg-success' : x.STATUS == 'OPEN', 
                                    'bg-primary' : x.STATUS == 'WIP',
                                    'bg-danger' : x.STATUS == 'HOLD',
                                    'bg-secondary' : x.STATUS == 'CLOSED'}" ng-bind="x.STATUS" title="Status"></span>
                          <span class="badge" ng-class="x.TICKETID == ticketid ? 'badge-light' : 'badge-dark'" title="Priority" ng-bind="x.PRIORITY"></span>
                          <button title="Delete Ticket" data-toggle="modal" data-target="#CancelTicketModal" ng-click="OpenCancelTicketModal(x.TICKETID);" class="btn btn-green px-1 py-0 ml-1 rounded"><i class="fa fa-trash"></i></button>
                        </div>
                      </div>
                    </h4>
                    <h5 class="mb-0 px-3 py-2" ng-class="x.TICKETID == ticketid ? 'bg-dark text-light' : 'bg-light'">
                      <span class="fa fa-user pr-2"></span>
                      <span ng-show="x.TICKET_BY == 'ADMIN'" class="" ng-bind="x.TICKET_BY_NAME"></span>
                      <span ng-show="x.TICKET_BY == 'ADMIN'" class="fa fa-long-arrow-right"></span>
                      <span ng-class="x.TICKET_BY == 'ADMIN'?'font-weight-bold':''" ng-bind="x.STUDENT_NAME"></span>
                      <span class="pull-right font-weight-bold" ng-bind="x.TICKETDATE"></span>
                      <span class="fa fa-calendar pull-right px-2"></span>
                    </h5>
                  </li>
                </ul>
              </div>
            </div>
          </div>       
          
        <!-- UPDATE STATUS MODAL -->
        <div class="modal fade d-print-none" id="Status" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h3 class="modal-title font-weight-bold" id="exampleModalLabel">UPDATE STATUS</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <form novalidate name="UpdateStatusForm" class="" enctype="multipart/form-data" autocomplete="off">
                  <div class="row">
                    <div class="col-md-12 col-lg-12 col-sm-12">
                      <div class="form-group">
                          <label for="ddlStatus">Status :<span class="text-danger">*</span></label>
                          <select class="form-control" id="ddlStatus" ng-change='UPDATE_STATUS()' data-ng-model="temp.ddlStatus" autocomplete="off">
                            <option value="">--Select--</option>
                            <option value="HOLD">HOLD</option>
                            <option value="CLOSED">CLOSED</option>
                          </select>
                      </div>
                    </div>
                  </div>
                </form>    
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-danger btn-sm" data-dismiss="modal">Close</button>
                </div>
            </div>
          </div>
        </div>



        <!-- CREATE STUDENT TICKET MODAL -->
        <div class="modal fade d-print-none" id="TicketModal" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="TicketModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <h3 class="modal-title" id="TicketModalLabel">Create Student Ticket</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <form name="CreateTicketForm" enctype="multipart/form-data" autocomplete="off" novalidate>
                  <div class="row">
                    <div class="col-md-12 col-lg-4 col-sm-12">
                      <div class="form-group">
                        <label for="ddlPlanCT">Plan :<span class="text-danger">*</span> <i class="fa fa-spinner fa-spin spinPlan" style="display: none;"></i></label>
                        <select class="form-control" id="ddlPlanCT" data-ng-model="temp.ddlPlanCT" ng-change="getStudentByPlan()" autofocus autocomplete="off" required>
                          <option value="">--Select Plan--</option>
                          <option ng-repeat="x in post.getPlan | orderBy:'PLANNAME'" value="{{x.PLANID}}" ng-bind="x.PLANNAME"></option>
                        </select>
                      </div>
                    </div>
  
                    <div class="col-md-12 col-lg-4 col-sm-12">
                      <div class="form-group">
                        <label for="ddlStudentCT">Student :<span class="text-danger">*</span> <i class="fa fa-spinner fa-spin spinStudent" style="display: none;"></i></label>
                        <select class="form-control" id="ddlStudentCT" data-ng-model="temp.ddlStudentCT" 
                          ng-disabled="post.getStudentByPlan.length<=0 || !temp.ddlPlanCT"
                          autofocus autocomplete="off" required>
                          <option value="">--Select Student--</option>
                          <option ng-repeat="x in post.getStudentByPlan | orderBy:'FIRSTNAME'" value="{{x.REGID}}" ng-bind="x.FIRSTNAME +' '+ x.LASTNAME"></option>
                        </select>
                      </div>
                    </div>
                    
                    <div class="col-md-12 col-lg-4 col-sm-12">
                      <div class="form-group">
                          <label for="ddlPriorityCT">Priority :<span class="text-danger">*</span></label>
                          <select class="form-control" id="ddlPriorityCT" data-ng-model="temp.ddlPriorityCT" autocomplete="off" required>
                            <option value="">--Select--</option>
                            <option value="LOW">Low</option>
                            <option value="MEDIUM">Medium</option>
                            <option value="HIGH">High</option>
                          </select>
                      </div>
                    </div>

                    <div class="col-md-12 col-lg-12 col-sm-12">
                      <div class="form-group">
                          <label for="textSubjectCT">Subject :<span class="text-danger">*</span></label>
                          <input type="text" class="form-control" id="textSubjectCT" placeholder="Type here..." data-ng-model="temp.textSubjectCT" autocomplete="off" required>
                      </div>
                    </div>

                    <div class="col-md-12 col-lg-12 col-sm-12">
                      <div class="form-group">
                          <label for="txtCommentCT">Comment :<span class="text-danger">*</span></label>
                          <textarea class="form-control" id="txtCommentCT" rows="5" data-ng-model="temp.txtCommentCT" autocomplete="off" required></textarea>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="modal-footer d-flex justify-content-between">
                  <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                  <button ng-disabled="CreateTicketForm.$invalid" ng-click="createTicket()" type="button" class="btn btn-dark btnCreate">CREATE</button>
                </form>
              </div>
            </div>
          </div>
        </div>



        <!-- DELETE TICKET MODAL -->
        <div class="modal fade d-print-none" id="CancelTicketModal" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-labelledby="CancelTicketLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h3 class="modal-title" id="CancelTicketLabel">Cancel Ticket</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <form name="cancelTicketForm">
                  <div class="row">
                    <div class="col-12">
                      <div class="form-group">
                        <label for="txtReasoneTC">Reasone :<span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="txtReasoneTC" placeholder="Type here..." data-ng-model="temp.txtReasoneTC" autocomplete="off" required>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="modal-footer d-flex justify-content-between">
                  <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                  <button ng-disabled="cancelTicketForm.$invalid" ng-click="deleteTicket();" type="button" class="btn btn-dark btnCancelTicket">Save</button>
                </form>
                </div>
            </div>
          </div>
        </div>


        <!-- TABLE FOR EXCEL -->
        <table class="table table-sm table-bordered table2excel d-none d-print-block">
          <thead>
            <tr>
              <th>TICKET DATE</th>
              <!-- <th>REGID</th> -->
              <th>STUDENT</th>
              <th>SUBJECT</th>
              <th>STATUS</th>
              <th>PRIORITY</th>
              <th>TICKET BY</th>
              <th>TICKET BY NAME</th>
              <th>CLOSED BY</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="x in post.getAllTicket | filter:temp.search">
              <td ng-bind="x.TICKETDATE"></td>
              <!-- <td ng-bind="x.REGID"></td> -->
              <td ng-bind="x.STUDENT_NAME +' ('+x.REGID+')'"></td>
              <td ng-bind="x.SUBJECT"></td>
              <td ng-bind="x.STATUS"></td>
              <td ng-bind="x.PRIORITY"></td>
              <td ng-bind="x.TICKET_BY == '' ? '-' : x.TICKET_BY"></td>
              <td ng-bind="x.TICKET_BY_NAME == '' ? '-' : x.TICKET_BY_NAME"></td>
              <td ng-bind="x.CLOSEDBY"></td>
            </tr>
          </tbody>
        </table>

      </section>
    </div>
	</div>
  <div id="_mobile_column_left" class="container d-print-none"></div>
  <div id="_mobile_column_right" class="container d-print-none"></div>


  <div class="mt-auto d-print-none" ng-include="'include/footer.html?ver=6'"></div>

  <!-- JS FILE -->
  
  <!-- =========== Excel ========== -->
  <script src="../js/excel/jquery.table2excel.js" type="text/javascript"></script>
  <script>
    $(function() {
        $(".exportToExcel").click(function(e){
          var table = $(this).prev('.table2excel');
          var preserveColors = (table.hasClass('table2excel_with_colors') ? true : false);
          var date = new Date();
          date = date.getDate()+"-"+(date.getMonth()+1)+"-"+date.getFullYear();
          $('.table2excel').table2excel({
              exclude: ".noExl",
              name: "Excel Document Name",
              filename: date + "_STUDENT_SUPPORT_TICKET.xls",
              fileext: ".xls",
              exclude_img: true,
              exclude_links: true,
              exclude_inputs: true,
              preserveColors: preserveColors
          });
        });
    });
  </script>
</body></html>   