<!DOCTYPE html>
<!--[if IE]><![endif]-->
<!--[if IE 8 ]><html dir="ltr" lang="en" class="ie8"><![endif]-->
<!--[if IE 9 ]><html dir="ltr" lang="en" class="ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!-->
  <html dir="ltr" lang="en">
    <!--<![endif]-->
    <head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="format-detection" content="telephone=no">
<link href="../images/favicon1.png" rel="icon" />
<title>MyExamPrep</title>
<!-- <base href="http://localhost:8080/myexamsprep/backoffice/" /> -->
<meta name="description" content="Personalized Tutoring" />
<script src="../js/jquery-2.1.1.min.js" type="text/javascript"></script>
<!-- <script src="../js/jquery-3.3.1.slim.min.js" type="text/javascript"></script> -->
<link href="../css/bootstrap.min.css" rel="stylesheet" media="screen" />
<!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"> -->
<script src="../js/bootstrap.min.js" type="text/javascript"></script>
<link href="https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300" rel="stylesheet" type="text/css">
<link href="../css/font-awesome.min.css" rel="stylesheet" type="text/css" />
<link rel="stylesheet" type="text/css" href="../css/magnific-popup.css" />
<link href="//fonts.googleapis.com/css?family=Open+Sans:400,400i,300,700" rel="stylesheet" type="text/css" />
<link href="../css/owl.carousel.min.css" rel="stylesheet">
<script src="../js/owl.carousel.min.js" type="text/javascript"></script>
<script src="../js/theme.js" type="text/javascript"></script>
<link href="../css/stylesheet.css?ver=5" rel="stylesheet">



<script src="../js/common.js" type="text/javascript"></script>
<script src="../js/popper.min.js" type="text/javascript"></script>
<script src="../js/support.js" type="text/javascript"></script>
<link href="../css/font-awesome.min.css" rel="stylesheet" type="text/css" />
<script src="../js/jquery.magnific-popup.min.js"></script>
<script src="../js/moment.min.js" type="text/javascript"></script>
<script src="../js/moment-with-locales.min.js" type="text/javascript"></script>
<script src="../js/bootstrap-datetimepicker.min.js" type="text/javascript"></script>


<!-- #Angular Js -->
<script src="../angular_js/angular.min.js" type="text/javascript"></script>
<script src="../angular_js/angular-route.js" type="text/javascript"></script>
<script src="../angular_js/angular-animate.js" type="text/javascript"></script>
<script src="../angular_js/angular-sanitize.js" type="text/javascript"></script>

<!-- Material Angular -->
<script src="../angular_js/material/angular-aria.min.js" type="text/javascript"></script>
<script src="../angular_js/material/angular-material.js" type="text/javascript"></script>
<link href="../angular_js/material/angular-material.css" rel="stylesheet" type="text/css" />

<!-- Pageing -->
<!-- <script src="../angular_js/dirPagination.js" type="text/javascript"></script>
<link href="../css/paging.css" rel="stylesheet"> -->

<!-- Multiselect -->
<!-- <script src="../js/lodash.min.js"></script>
<script src="../js/multiselectDropdown/dist/angularjs-dropdown-multiselect.min.js"></script>
<link rel="stylesheet" href="../css/multiSelect.css">
<link rel="stylesheet" href="../css/bootstrap-glyphicons.css"> -->

<script src="code/SMS_HISTORY.js?ver=5"></script>

<!-- ON PRINT -->
<link rel="stylesheet" href="../css/OnPrint.css?ver=5">

<style>
  @media print{
    .mytb{
      max-width: 100%!important;
    }
  }
</style>
</head>
<body data-ng-app="myApp" data-ng-controller="myCtrl" data-ng-init="init()" class="d-flex flex-column min-vh-100">
 
    

    <!-- Header -->
<div id="menu_wrapper"></div>
<header id="header" class="home">
      
  <div ng-include="'include/header.html?ver=5'"></div>
    
</header>


  <div id="spin-wrapper"></div>
  <div id="siteloader">
      <div class="loader loader-1"></div>
  </div>


	<div id="common-home">    
    <div class="content_middle">
        <section class="ishiproductsblock container mb-0">
          <div class="section-header">
            <h4 class="home-title mb-0"><span>SMS HISTORY</span></h4>
          </div>

          <div class="row" style="text-align:left">
            <div class="col-sm-12 my-2 d-print-none">
              <div class="bg-white card card-body rounded-my">
                <!-- ADD COURSE COVERAGE START -->
                <form novalidate name="Form" enctype="multipart/form-data" autocomplete="off">
                  <div class="row">
                    <div class="col-md-4 col-lg-2 col-sm-12">
                      <div class="form-group mb-0">
                        <label class="font-weight-bold" for="txtFromDT">From :</label>
                        <input type="date" class="form-control py-0" id="txtFromDT" data-ng-model="temp.txtFromDT" 
                        ng-change="getMSGHistory()" onfocus="select()" autocomplete="off" required>
                      </div>
                    </div>
                    <div class="col-md-4 col-lg-2 col-sm-12">
                      <div class="form-group mb-0">
                        <label class="font-weight-bold" for="txtToDT">To :</label>
                        <input type="date" class="form-control py-0" id="txtToDT" data-ng-model="temp.txtToDT" 
                        ng-change="getMSGHistory()"  onfocus="select()" autocomplete="off" required>
                      </div>
                    </div>

                    <div class="col-sm-12 col-md-4 col-lg-2 d-flex align-items-end py-1">
                      <button class="btn btn-outline-danger btn-sm mx-1" data-ng-click="clearForm()">CLEAR</button>
                    </div>
                  </div>
                </form>
                <!-- ADD COURSE COVERAGE END -->


                  <!-- <div class="row mt-3">
                    <div class="col-md-4 col-lg-12 col-sm-12 d-flex align-items-end py-0 justify-content-center">
                      <button ng-disabled="Form.$invalid" data-ng-hide="temp.sccid" data-ng-disabled="all" type="submit" class="btn btn-dark btn-sm btn-save" data-ng-click="saveData()">SEND</button>
                      <button class="btn btn-outline-danger btn-sm mx-1" data-ng-click="clearForm()">CLEAR</button>
                    </div>
                  </div> -->
              
              </div>
            </div>
          </div>

          
          <div class="row">
            <div class="col-12 d-flex justify-content-center d-print-none">
              <ul class="nav nav-pills" id="pills-tab" role="tablist">
                <li class="nav-item mx-2" role="presentation">
                  <button class="nav-link active" id="pills-outgoing-tab" data-toggle="pill" data-target="#pills-outgoing" type="button" role="tab" aria-controls="pills-settled" aria-selected="true">OUTGOING SMS</button>
                </li>
                <li class="nav-item mx-2" role="presentation">
                  <button class="nav-link" id="pills-incoming-tab" data-toggle="pill" data-target="#pills-incoming" type="button" role="tab" aria-controls="pills-unsettled" aria-selected="false">INCOMING SMS</button>
                </li>
                <li class="nav-item mx-2" role="presentation" ng-if="SHOW_UNDELIVERED">
                  <button class="nav-link" id="pills-undelivered-tab" data-toggle="pill" data-target="#pills-undelivered" type="button" role="tab" aria-controls="pills-unsettled" aria-selected="false">UNDELIVERED & FAILED SMS</button>
                </li>
              </ul>
            </div>



            <div class="col-sm-12 my-2">
              <div class="tab-content" id="pills-tabContent">
                <div class="row d-print-none" id="SpinMainData" style="display: none;">
                  <div class="col-12 text-center">
                    <div class="spinner-grow" role="status">
                      <span class="sr-only">Loading...</span>
                    </div>
                    <div class="spinner-grow" role="status">
                      <span class="sr-only">Loading...</span>
                    </div>
                    <div class="spinner-grow" role="status">
                      <span class="sr-only">Loading...</span>
                    </div>
                  </div>
                </div>

                <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
                <!--================== OUTGOING TABLE ==================-->
                <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
                <div class="tab-pane fade show active" id="pills-outgoing" role="tabpanel" aria-labelledby="pills-outgoing-tab">
                  <div class="table-responsive pb-0 card card-body rounded-my mt-2">
                    <div class="row">
                      <div class="col-sm-12 col-md-12 col-lg-12 card-body mytb">
                        <div class="row d-print-none">
                          <div class="col-md-4 col-lg-3 col-sm-12">
                            <div class="form-group mb-0">
                              <label class="font-weight-bold" for="txtSerarch">Search by Anything :</label>
                              <input type="text" class="form-control py-0" id="txtSerarch" data-ng-model="temp.txtSerarch" placeholder="Type Here..." onfocus="select()" autocomplete="off" required>
                            </div>
                          </div>
                          
        
                          <div class="col-sm-12 col-md-8 col-lg-9 d-flex align-items-end py-3 justify-content-end">
                            <button class="btn btn-success text-light btn-sm mx-1 exportToExcel" onclick="CreateExcel('OUTGOING')">
                              <i class="fa fa-file-excel-o pr-1"></i> Excel
                            </button>
                            <!-- <button class="btn btn-dark text-light btn-sm mx-1" onclick="print()">
                              <i class="fa fa-print pr-1"></i> Print
                            </button> -->
                          </div>
                        </div> 
    
                        <div class="">
                          <table class="table table-bordered table-hover bg-white table-sm mt-0 table2excel">
                            <thead>
                              <tr class="thead-dark">
                                <th colspan="8" style="background-color:steelblue;">
                                  <h4 class="text-center mb-0 text-white"><b>OUTGOING SMS</b></h4>
                                </th>
                              </tr>
                              <tr class="bg-light">
                                  <th>#</th>
                                  <th>Date</th>
                                  <th>MSG From</th>
                                  <th>MSG Type</th>
                                  <th>Student Type</th>
                                  <th>Student</th>
                                  <th>Mobile</th>
                                  <th>Message</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr title="{{x.MSGID+' | LOCID : '+x.LOCATIONID}}" ng-repeat="x in post.OUTGOING_MSG | filter : temp.txtSerarch">
                                  <td data-ng-bind="$index+1"></td>
                                  <td ng-bind="x.MSGDATE"> </td>
                                  <td ng-bind="x.MSG_FROM"></td>
                                  <td ng-bind="x.MSGTYPE"></td>
                                  <td ng-bind="(x.STUDENTTYPE && x.STUDENTTYPE!='') ? x.STUDENTTYPE : '&#8212;'"></td>
                                  <td ng-bind="(x.FIRSTNAME && x.FIRSTNAME!='') ? x.FIRSTNAME +' '+ x.LASTNAME : '&#8212;'"></td>
                                  <td ng-bind="x.MOBILENO"></td>
                                  <td class="text-break" ng-bind="x.TEXTMESSAGE"></td>
                              </tr>
                            </tbody>
                            <tfoot>
                              <tr ng-hide="post.OUTGOING_MSG.length>0">
                                <td colspan="100%" class="text-center text-danger noExl">No Records</td>
                              </tr>
                            </tfoot>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
                <!--================== OUTGOING TABLE ==================-->
                <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->









                <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
                <!--================== INCOMING TABLE ==================-->
                <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
                <div class="tab-pane fade" id="pills-incoming" role="tabpanel" aria-labelledby="pills-incoming-tab">
                  <div class="table-responsive pb-0 card card-body rounded-my mt-2">
                    <div class="row">
                      <div class="col-sm-12 col-md-12 col-lg-12 card-body mytb">
                        <div class="row d-print-none">
                          <div class="col-md-4 col-lg-3 col-sm-12">
                            <div class="form-group mb-0">
                              <label class="font-weight-bold" for="txtSerarch_ICS">Search by Anything :</label>
                              <input type="text" class="form-control py-0" id="txtSerarch_ICS" data-ng-model="temp.txtSerarch_ICS" placeholder="Type Here..." onfocus="select()" autocomplete="off" required>
                            </div>
                          </div>
                          
        
                          <div class="col-sm-12 col-md-8 col-lg-9 d-flex align-items-end py-3 justify-content-end">
                            <button class="btn btn-success text-light btn-sm mx-1 exportToExcel" onclick="CreateExcel('INCOMING')">
                              <i class="fa fa-file-excel-o pr-1"></i> Excel
                            </button>
                            <!-- <button class="btn btn-dark text-light btn-sm mx-1" onclick="print()">
                              <i class="fa fa-print pr-1"></i> Print
                            </button> -->
                          </div>
                        </div> 
                        <div class="">
                          <table class="table table-bordered table-hover bg-white table-sm mt-0 table2excel_INC">
                            <thead>
                              <tr class="thead-dark">
                                <th colspan="9" style="background-color:olivedrab;">
                                  <h4 class="text-center mb-0 text-white"><b>INCOMING SMS</b></h4>
                                </th>
                              </tr>
                              <tr class="bg-light">
                                  <th>#</th>
                                  <th>Date</th>
                                  <th>MSG Type</th>
                                  <!-- <th>Student Type</th> -->
                                  <th>Student</th>
                                  <th>Mobile</th>
                                  <th>Message</th>
                                  <th class="d-print-none">Reply</th>
                                  <th class="d-print-none">#</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr title="{{x.MSGID+' | LOCID : '+x.LOCATIONID}}" ng-repeat="x in post.INCOMING_MSG | filter : temp.txtSerarch_ICS" ng-class="x.REPLIED ? 'table-success' : x.CHECK_REPLY == 'NO REPLY' ? 'table-danger' : ''">
                                  <td data-ng-bind="$index+1"></td>
                                  <td ng-bind="x.MSGDATE"> </td>
                                  <td ng-bind="x.MSGTYPE"></td>
                                  <!-- <td ng-bind="(x.STUDENTTYPE && x.STUDENTTYPE!='') ? x.STUDENTTYPE : '&#8212;'"></td> -->
                                  <td ng-bind="(x.STUDENT_NAME && x.STUDENT_NAME!='') ? x.STUDENT_NAME : '&#8212;'"></td>
                                  <td ng-bind="x.MOBILENO"></td>
                                  <td class="text-break" ng-bind="x.TEXTMESSAGE"></td>
                                  <td class="d-print-none">
                                    <button class="btn p-0" ng-click="openReplySmsModal(x)" data-toggle="modal" data-target="#replySmsModal">
                                      <i class="fa fa-reply" style="text-shadow: 2px 3px 5px #0000003d;"></i>
                                    </button>
                                  </td>
                                  <td class="d-print-none">
                                    <button class="btn btn-dark px-2 py-1 rounded-circle font-12 btn-markReply" title="Mark to Reply" ng-click="markReply(x)">R</button>
                                  </td>
                              </tr>
                            </tbody>
                            <tfoot>
                              <tr ng-hide="post.INCOMING_MSG.length>0">
                                <td colspan="100%" class="text-center text-danger noExl">No Records</td>
                              </tr>
                            </tfoot>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
                <!--================== INCOMING TABLE ==================-->
                <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->









                <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
                <!--================== UNDELIVERED/FAILED TABLE ==================-->
                <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
                <div class="tab-pane fade" id="pills-undelivered" role="tabpanel" aria-labelledby="pills-undelivered-tab" ng-if="SHOW_UNDELIVERED">
                  <div class="tab-pane fade show active" id="pills-outgoing" role="tabpanel" aria-labelledby="pills-outgoing-tab">
                    <div class="table-responsive pb-0 card card-body rounded-my mt-2">
                      <div class="row">
                        <div class="col-sm-12 col-md-12 col-lg-12 card-body mytb">
                          <div class="row d-print-none">
                            <div class="col-md-4 col-lg-3 col-sm-12">
                              <div class="form-group mb-0">
                                <label class="font-weight-bold" for="txtSerarch_UF">Search by Anything :</label>
                                <input type="text" class="form-control py-0" id="txtSerarch_UF" data-ng-model="temp.txtSerarch_UF" placeholder="Type Here..." onfocus="select()" autocomplete="off" required>
                              </div>
                            </div>
                            
          
                            <div class="col-sm-12 col-md-8 col-lg-9 d-flex align-items-end py-3 justify-content-end">
                              <button class="btn btn-success text-light btn-sm mx-1 exportToExcel" onclick="CreateExcel('UNDELIVERED')">
                                <i class="fa fa-file-excel-o pr-1"></i> Excel
                              </button>
                              <!-- <button class="btn btn-dark text-light btn-sm mx-1" onclick="print()">
                                <i class="fa fa-print pr-1"></i> Print
                              </button> -->
                            </div>
                          </div> 
      
                          <div class="">
                            <table class="table table-bordered table-hover bg-white table-sm mt-0 table2excel_UNDELIVERED">
                              <thead>
                                <tr class="thead-dark">
                                  <th colspan="10" style="background-color:indianred;">
                                    <h4 class="text-center mb-0 text-white"><b>UNDELIVERED & FAILED SMS</b></h4>
                                  </th>
                                </tr>
                                <tr class="bg-light">
                                    <th>#</th>
                                    <th>Date</th>
                                    <th>MSG From</th>
                                    <th>MSG Type</th>
                                    <th>Status</th>
                                    <th>Student Type</th>
                                    <th>Student</th>
                                    <th>Mobile</th>
                                    <th>Message</th>
                                    <th>Remark</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr title="{{x.MSGID+' | LOCID : '+x.LOCATIONID}}" ng-repeat="x in post.FAILED_UNDELIVERED_MSG | filter : temp.txtSerarch_UF">
                                    <td data-ng-bind="$index+1"></td>
                                    <td ng-bind="x.MSGDATE"> </td>
                                    <td ng-bind="x.MSG_FROM"></td>
                                    <td ng-bind="x.MSGTYPE"></td>
                                    <td ng-bind="x.MSG_STATUS"></td>
                                    <td ng-bind="(x.STUDENTTYPE && x.STUDENTTYPE!='') ? x.STUDENTTYPE : '&#8212;'"></td>
                                    <td ng-bind="(x.STUDENT_NAME) ? x.STUDENT_NAME : '&#8212;'"></td>
                                    <td ng-bind="x.MOBILENO"></td>
                                    <td class="text-break" ng-bind="x.TEXTMESSAGE"></td>
                                    <td class="text-break" ng-bind="x.REMARK"></td>
                                </tr>
                              </tbody>
                              <tfoot>
                                <tr ng-hide="post.FAILED_UNDELIVERED_MSG.length>0">
                                  <td colspan="100%" class="text-center text-danger noExl">No Records</td>
                                </tr>
                              </tfoot>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->
                <!--================== UNDELIVERED/FAILED TABLE ==================-->
                <!--%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-->

              </div>  


              <!-- <div class="row d-print-none">
                <div class="col-12 text-right">
                  <button class="btn btn-dark text-light btn-sm mx-1" onclick="print()">
                    <i class="fa fa-print pr-1"></i> Print
                  </button>
                </div>
              </div> -->
              
            </div>
          </div>
      </section>


      <!--================= REPLY SMS MODAL =================-->
      <div class="modal fade d-print-none" id="replySmsModal" tabindex="-1" aria-labelledby="replySmsModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header py-2">
              <h3 class="modal-title" id="replySmsModalLabel">Reply to :  <b ng-bind='REPLY_NUMBER'></b></h3>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body p-2">
              <form name="replysmsform" novalidate autocomplete="off">
                <div class="row">
                  <div class="col-12">
                    <div class="form-group mb-0">
                      <select data-ng-model="temp.ddlTextFrom" id="ddlTextFrom" class="form-control" required>
                        <option value="">Select Text From</option>
                        <option value="STUDENT_SMS">Student Sms</option>
                        <option value="CONTACTUS_SMS">Contact Us Sms</option>
                      </select>
                    </div>
                  </div>
                  <div class="col-12">
                    <div class="form-group mb-0">
                      <textarea rows="4" data-ng-model="temp.txtReplySms" id="txtReplySms" class="form-control" placeholder="Type here..." required></textarea>
                    </div>
                  </div>
                </div>
              </div>
              <div class="modal-footer py-2 d-flex justify-content-between">
                <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-close"></i> CLOSE</button>
                <button type="button" ng-disabled="replysmsform.$invalid" data-ng-click="sendSms()" class="btn btn-success btnSend"><i class="fa fa-send"></i> SEND</button>
              </div>
            </form>
          </div>
        </div>
      </div>
      <!--================= REPLY SMS MODAL =================-->
    </div>
	</div>
  <div id="_mobile_column_left" class="container"></div>
  <div id="_mobile_column_right" class="container"></div>



  <!--================== ALERT ==================-->
  <div class="d-flex justify-content-md-end justify-content-sm-center w-100 fixed-bottom p-2 d-print-none" id="myToastMain" style="bottom: -80px;">
    <div class="toast w-100 fade shadow-lg" role="alert" id="myToast" aria-live="assertive" aria-atomic="true" data-delay="5000">
      <div class="toast-header text-light">
        <strong class="mr-auto">Alert</strong>
        <small class="">just now</small>
        <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="toast-body alert-light">
        <samp class="font-weight-bold"></samp>
      </div>
    </div>
  </div>
<!--================== ALERT ==================-->

  <div class="mt-auto d-print-none" ng-include="'include/footer.html?ver=5'"></div>

  <!-- MULTI SELECT -->
  <script>
    $(document).ready(function() { 
      $("#PLANS,#PRODUCTS,#STUDENTS").find('div').css({'width':'100%'});
      $("#PLANS,#PRODUCTS,#STUDENTS").find('button').addClass('btn-block');
      // $('.dropdown-toggle').attr('disabled','disabled');
    });
  </script>
  <!-- MULTI SELECT -->

  <script src="../js/excel/jquery.table2excel.js" type="text/javascript"></script>
  <script>
    $(function() {
        CreateExcel = function(e){
          // alert(e);
          // var table = $(this).prev('.table2excel');
          if(e == 'OUTGOING'){
            var table = $(this).prev('.table2excel');
            var preserveColors = (table.hasClass('table2excel_with_colors') ? true : false);
            var date = new Date();
            date = date.getDate()+"-"+(date.getMonth()+1)+"-"+date.getFullYear();
            $('.table2excel').table2excel({
                exclude: ".noExl",
                name: "Excel Document Name",
                filename: date + "_SMS_OUTGOING_History.xls",
                fileext: ".xls",
                exclude_img: true,
                exclude_links: true,
                exclude_inputs: true,
                preserveColors: preserveColors
            });
          }
          else if(e == 'INCOMING'){
            var table = $(this).prev('.table2excel_INC');
            var preserveColors = (table.hasClass('table2excel_with_colors') ? true : false);
            var date = new Date();
            date = date.getDate()+"-"+(date.getMonth()+1)+"-"+date.getFullYear();
            $('.table2excel_INC').table2excel({
                exclude: ".noExl",
                name: "Excel Document Name",
                filename: date + "_SMS_INCOMING_History.xls",
                fileext: ".xls",
                exclude_img: true,
                exclude_links: true,
                exclude_inputs: true,
                preserveColors: preserveColors
            });

          }
          else if(e == 'UNDELIVERED'){
            var table = $(this).prev('.table2excel_UNDELIVERED');
            var preserveColors = (table.hasClass('table2excel_with_colors') ? true : false);
            var date = new Date();
            date = date.getDate()+"-"+(date.getMonth()+1)+"-"+date.getFullYear();
            $('.table2excel_UNDELIVERED').table2excel({
                exclude: ".noExl",
                name: "Excel Document Name",
                filename: date + "_SMS_Undelivered_Failed.xls",
                fileext: ".xls",
                exclude_img: true,
                exclude_links: true,
                exclude_inputs: true,
                preserveColors: preserveColors
            });

          }

            
        };
    });
  </script>
</body></html>   